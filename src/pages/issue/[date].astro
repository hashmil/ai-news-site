---
import Base from '../../layouts/Base.astro';
import Section from '../../components/Section.astro';
import Story from '../../components/Story.astro';
import briefings from '../../data/briefings.json';
import imageMap from '../../data/image-map.json';

export function getStaticPaths() {
  return briefings.map((b) => ({
    params: { date: b.date },
    props: { briefing: b },
  }));
}

const { briefing } = Astro.props;
---
<Base title={briefing.date}>
  <span class="date-header">{briefing.title}</span>
  {briefing.sections.map((section) => (
    <Section heading={section.heading}>
      {section.stories.map((story) => (
        <Story
          number={story.number}
          headline={story.headline}
          description={story.description}
          url={story.url}
          imageUrl={(imageMap as Record<string, string | null>)[story.url]}
          sectionType={section.type}
        />
      ))}
    </Section>
  ))}
</Base>
